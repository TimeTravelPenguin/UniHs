<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Commands</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Commands.html#runProgram"><span class="hs-identifier">runProgram</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Actions.CourseDirectory.html"><span class="hs-identifier">Actions.CourseDirectory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Actions.CourseDirectory.html#createNewAssessmentInLocation"><span class="hs-identifier">createNewAssessmentInLocation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Configuration.html"><span class="hs-identifier">Data.Configuration</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Configuration.html#Configuration"><span class="hs-identifier">Configuration</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Options.html"><span class="hs-identifier">Options</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Options.html#AppArgs"><span class="hs-identifier">AppArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Options.html#AppArgs"><span class="hs-identifier">AppArgs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Options.html#AssessmentCopyToLocation"><span class="hs-identifier">AssessmentCopyToLocation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Options.html#ProgramCommand"><span class="hs-identifier">ProgramCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Options.html#CreateAssessment"><span class="hs-identifier">CreateAssessment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Options.html#GradingCLI"><span class="hs-identifier">GradingCLI</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Options.html#ProgramOptions"><span class="hs-identifier">ProgramOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Options.html#ProgramOptions"><span class="hs-identifier">ProgramOptions</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Options.html#getProgramOptions"><span class="hs-identifier">getProgramOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Path</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Abs</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Dir</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Path</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Printing.html"><span class="hs-identifier">Printing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Printing.html#sgrHyperlink"><span class="hs-identifier">sgrHyperlink</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Printing.html#sgrPutStr"><span class="hs-identifier">sgrPutStr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Printing.html#sgrPutStrLn"><span class="hs-identifier">sgrPutStrLn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Printing.html#sgrYellow"><span class="hs-identifier">sgrYellow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Printing.html#startSGRScope"><span class="hs-identifier">startSGRScope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="StringFormatters.html"><span class="hs-identifier">StringFormatters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="StringFormatters.html#cleanAbsDirPathString"><span class="hs-identifier">cleanAbsDirPathString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">type</span><span> </span><span id="ConfigurationReader"><span class="annot"><a href="Commands.html#ConfigurationReader"><span class="hs-identifier hs-var">ConfigurationReader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Data.Configuration.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="annot"><span class="hs-comment">-- | TODO: Need to implement configuration logics</span></span><span>
</span><span id="line-14"></span><span class="annot"><a href="Commands.html#runProgram"><span class="hs-identifier hs-type">runProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Configuration.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span id="runProgram"><span class="annot"><span class="annottext">runProgram :: Configuration -&gt; IO ()
</span><a href="Commands.html#runProgram"><span class="hs-identifier hs-var hs-var">runProgram</span></a></span></span><span> </span><span id="local-6989586621679166127"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679166127"><span class="hs-identifier hs-var">copyConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Options.html#ProgramOptions"><span class="hs-identifier hs-type">ProgramOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Options.html#AppArgs"><span class="hs-identifier hs-type">AppArgs</span></a></span><span> </span><span id="local-6989586621679166128"><span class="annot"><span class="annottext">ProgramCommand
</span><a href="#local-6989586621679166128"><span class="hs-identifier hs-var">command</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679166129"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679166129"><span class="hs-identifier hs-var">cwd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ProgramOptions
</span><a href="Options.html#getProgramOptions"><span class="hs-identifier hs-var">getProgramOptions</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProgramCommand
</span><a href="#local-6989586621679166128"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Options.html#CreateAssessment"><span class="hs-identifier hs-type">CreateAssessment</span></a></span><span> </span><span id="local-6989586621679166130"><span class="annot"><span class="annottext">AssessmentCopyToLocation
</span><a href="#local-6989586621679166130"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AssessmentCopyToLocation -&gt; Path Abs Dir -&gt; IO ()
</span><a href="Commands.html#newAssessmentInLocation"><span class="hs-identifier hs-var">newAssessmentInLocation</span></a></span><span> </span><span class="annot"><span class="annottext">AssessmentCopyToLocation
</span><a href="#local-6989586621679166130"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679166129"><span class="hs-identifier hs-var">cwd</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="annottext">ProgramCommand
</span><a href="Options.html#GradingCLI"><span class="hs-identifier hs-var">GradingCLI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This feature is currently not implemented.&quot;</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="annot"><a href="Commands.html#newAssessmentInLocation"><span class="hs-identifier hs-type">newAssessmentInLocation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Options.html#AssessmentCopyToLocation"><span class="hs-identifier hs-type">AssessmentCopyToLocation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span id="newAssessmentInLocation"><span class="annot"><span class="annottext">newAssessmentInLocation :: AssessmentCopyToLocation -&gt; Path Abs Dir -&gt; IO ()
</span><a href="Commands.html#newAssessmentInLocation"><span class="hs-identifier hs-var hs-var">newAssessmentInLocation</span></a></span></span><span> </span><span id="local-6989586621679166132"><span class="annot"><span class="annottext">AssessmentCopyToLocation
</span><a href="#local-6989586621679166132"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679166133"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679166133"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-23"></span><span>  </span><span id="local-6989586621679166134"><span class="annot"><span class="annottext">Either CourseDirectoryError (Path Abs Dir)
</span><a href="#local-6989586621679166134"><span class="hs-identifier hs-var">newAssess</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AssessmentCopyToLocation
-&gt; Path Abs Dir -&gt; IO (Either CourseDirectoryError (Path Abs Dir))
forall (m :: * -&gt; *).
MonadIO m =&gt;
AssessmentCopyToLocation
-&gt; Path Abs Dir -&gt; m (Either CourseDirectoryError (Path Abs Dir))
</span><a href="Actions.CourseDirectory.html#createNewAssessmentInLocation"><span class="hs-identifier hs-var">createNewAssessmentInLocation</span></a></span><span> </span><span class="annot"><span class="annottext">AssessmentCopyToLocation
</span><a href="#local-6989586621679166132"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679166133"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either CourseDirectoryError (Path Abs Dir)
</span><a href="#local-6989586621679166134"><span class="hs-identifier hs-var">newAssess</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679166135"><span class="annot"><span class="annottext">CourseDirectoryError
</span><a href="#local-6989586621679166135"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CourseDirectoryError -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">CourseDirectoryError
</span><a href="#local-6989586621679166135"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679166136"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679166136"><span class="hs-identifier hs-var">assess</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-27"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166137"><span class="annot"><span class="annottext">assessStr :: String
</span><a href="#local-6989586621679166137"><span class="hs-identifier hs-var hs-var">assessStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; String
</span><a href="StringFormatters.html#cleanAbsDirPathString"><span class="hs-identifier hs-var">cleanAbsDirPathString</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679166136"><span class="hs-identifier hs-var">assess</span></a></span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><span class="annottext">[SGR] -&gt; SGRStack () -&gt; IO ()
forall a. [SGR] -&gt; SGRStack a -&gt; IO a
</span><a href="Printing.html#startSGRScope"><span class="hs-identifier hs-var">startSGRScope</span></a></span><span> </span><span class="annot"><span class="annottext">[SGR]
</span><a href="Printing.html#sgrYellow"><span class="hs-identifier hs-var">sgrYellow</span></a></span><span> </span><span class="annot"><span class="annottext">(SGRStack () -&gt; IO ()) -&gt; SGRStack () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SGRStack ()
</span><a href="Printing.html#sgrPutStr"><span class="hs-identifier hs-var">sgrPutStr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Assessment created in: \&quot;&quot;</span></span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; SGRStack ()
</span><a href="Printing.html#sgrHyperlink"><span class="hs-identifier hs-var">sgrHyperlink</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166137"><span class="hs-identifier hs-var">assessStr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166137"><span class="hs-identifier hs-var">assessStr</span></a></span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; SGRStack ()
</span><a href="Printing.html#sgrPutStrLn"><span class="hs-identifier hs-var">sgrPutStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;.\n&quot;</span></span><span>
</span><span id="line-32"></span></pre></body></html>