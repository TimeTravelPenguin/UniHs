<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables, CPP #-}</span><span>
</span><span id="line-2"></span><span class="annot"><span class="hs-comment">{-|
    This module constructs command lines. You may either use the helper functions
    ('flagNone', 'flagOpt', 'mode' etc.) or construct the type directly. These
    types are intended to give all the necessary power to the person constructing
    a command line parser.

    For people constructing simpler command line parsers, the module
    &quot;System.Console.CmdArgs.Implicit&quot; may be more appropriate.

    As an example of a parser:

    @
    arguments :: 'Mode' [(String,String)]
    arguments = 'mode' \&quot;explicit\&quot; [] \&quot;Explicit sample program\&quot; ('flagArg' (upd \&quot;file\&quot;) \&quot;FILE\&quot;)
        ['flagOpt' \&quot;world\&quot; [\&quot;hello\&quot;,\&quot;h\&quot;] (upd \&quot;world\&quot;) \&quot;WHO\&quot; \&quot;World argument\&quot;
        ,'flagReq' [\&quot;greeting\&quot;,\&quot;g\&quot;] (upd \&quot;greeting\&quot;) \&quot;MSG\&quot; \&quot;Greeting to give\&quot;
        ,'flagHelpSimple' ((\&quot;help\&quot;,\&quot;\&quot;):)]
        where upd msg x v = Right $ (msg,x):v
    @

    And this can be invoked by:

    @
    main = do
        xs &lt;- 'processArgs' arguments
        if (\&quot;help\&quot;,\&quot;\&quot;) \`elem\` xs then
            print $ 'helpText' [] 'HelpFormatDefault' arguments
         else
            print xs
    @

    /Groups/: The 'Group' structure allows flags/modes to be grouped for the purpose of
    displaying help. When processing command lines, the group structure is ignored.

    /Modes/: The Explicit module allows multiple mode programs by placing additional modes
    in 'modeGroupModes'. Every mode is allowed sub-modes, and thus multiple levels of mode
    may be created. Given a mode @x@ with sub-modes @xs@, if the first argument corresponds
    to the name of a sub-mode, then that sub-mode will be applied. If not, then the arguments
    will be processed by mode @x@. Consequently, if you wish to force the user to explicitly
    enter a mode, simply give sub-modes, and leave 'modeArgs' as @Nothing@. Alternatively, if
    you want one sub-mode to be selected by default, place all it's flags both in the sub-mode
    and the outer mode.

    /Parsing rules/: Command lines are parsed as per most GNU programs. Short arguments single
    letter flags start with @-@, longer flags start with @--@, and everything else is considered
    an argument. Anything after @--@ alone is considered to be an argument. For example:

  &gt; -f --flag argument1 -- --argument2

    This command line passes one single letter flag (@f@), one longer flag (@flag@) and two arguments
    (@argument1@ and @--argument2@).
-}</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Console.CmdArgs.Explicit</span><span class="hs-special">(</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Running command lines</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Process.html#process"><span class="hs-identifier">process</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#processArgs"><span class="hs-identifier">processArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#processValue"><span class="hs-identifier">processValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#processValueIO"><span class="hs-identifier">processValueIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Constructing command lines</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.Type</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagHelpSimple"><span class="hs-identifier">flagHelpSimple</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagHelpFormat"><span class="hs-identifier">flagHelpFormat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagVersion"><span class="hs-identifier">flagVersion</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagNumericVersion"><span class="hs-identifier">flagNumericVersion</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagsVerbosity"><span class="hs-identifier">flagsVerbosity</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Displaying help</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Help.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.Help</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utilities for working with command lines</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.ExpandArgsAt.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.ExpandArgsAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.SplitJoin.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.SplitJoin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Complete.html#Complete"><span class="hs-identifier">Complete</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Complete.html#complete"><span class="hs-identifier">complete</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.Type</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Process.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.Process</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Help.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.Help</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.ExpandArgsAt.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.ExpandArgsAt</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.SplitJoin.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.SplitJoin</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Complete.html"><span class="hs-identifier">System.Console.CmdArgs.Explicit.Complete</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Default.html"><span class="hs-identifier">System.Console.CmdArgs.Default</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Helper.html"><span class="hs-identifier">System.Console.CmdArgs.Helper</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Text.html"><span class="hs-identifier">System.Console.CmdArgs.Text</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Verbosity.html"><span class="hs-identifier">System.Console.CmdArgs.Verbosity</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Process the flags obtained by @'getArgs'@ and @'expandArgsAt'@ with a mode. Displays</span><span>
</span><span id="line-88"></span><span class="hs-comment">--   an error and exits with failure if the command line fails to parse, or returns</span><span>
</span><span id="line-89"></span><span class="hs-comment">--   the associated value. Implemented in terms of 'process'. This function makes</span><span>
</span><span id="line-90"></span><span class="hs-comment">--   use of the following environment variables:</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- * @$CMDARGS_COMPLETE@ - causes the program to produce completions using 'complete', then exit.</span><span>
</span><span id="line-93"></span><span class="hs-comment">--   Completions are based on the result of 'getArgs', the index of the current argument is taken</span><span>
</span><span id="line-94"></span><span class="hs-comment">--   from @$CMDARGS_COMPLETE@ (set it to @-@ to complete the last argument), and the index within</span><span>
</span><span id="line-95"></span><span class="hs-comment">--   that argument is taken from @$CMDARGS_COMPLETE_POS@ (if set).</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- * @$CMDARGS_HELPER@\/@$CMDARGS_HELPER_/PROG/@ - uses the helper mechanism for entering command</span><span>
</span><span id="line-98"></span><span class="hs-comment">--   line programs as described in &quot;System.Console.CmdArgs.Helper&quot;.</span><span>
</span><span id="line-99"></span><span id="local-6989586621679279165"><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#processArgs"><span class="hs-identifier hs-type">processArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679279165"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679279165"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-100"></span><span id="processArgs"><span class="annot"><span class="annottext">processArgs :: forall a. Mode a -&gt; IO a
</span><a href="System.Console.CmdArgs.Explicit.html#processArgs"><span class="hs-identifier hs-var hs-var">processArgs</span></a></span></span><span> </span><span id="local-6989586621679279297"><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279297"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679279298"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679279298"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(String, String)]
</span><span class="hs-identifier hs-var">getEnvironment</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(String, String)] -&gt; Maybe String
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CMDARGS_COMPLETE&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679279298"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679279301"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279301"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>            </span><span id="local-6989586621679279302"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279302"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [String]
</span><span class="hs-identifier hs-var">getArgs</span></span><span>
</span><span id="line-105"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679279309"><span class="annot"><span class="annottext">argInd :: Int
</span><a href="#local-6989586621679279309"><span class="hs-identifier hs-var hs-var">argInd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279302"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="System.Console.CmdArgs.Explicit.html#readMay"><span class="hs-identifier hs-var">readMay</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279301"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-106"></span><span>                </span><span id="local-6989586621679279327"><span class="annot"><span class="annottext">argPos :: Int
</span><a href="#local-6989586621679279327"><span class="hs-identifier hs-var hs-var">argPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679279309"><span class="hs-identifier hs-var">argInd</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679279309"><span class="hs-identifier hs-var">argInd</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279302"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279302"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679279309"><span class="hs-identifier hs-var">argInd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-107"></span><span>                         </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="System.Console.CmdArgs.Explicit.html#readMay"><span class="hs-identifier hs-var">readMay</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Int) -&gt; Maybe String -&gt; Maybe Int
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [(String, String)] -&gt; Maybe String
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CMDARGS_COMPLETE_POS&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679279298"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-108"></span><span>            </span><span class="annot"><span class="annottext">[Complete] -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">([Complete] -&gt; IO ()) -&gt; [Complete] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Mode a -&gt; [String] -&gt; (Int, Int) -&gt; [Complete]
forall a. Mode a -&gt; [String] -&gt; (Int, Int) -&gt; [Complete]
</span><a href="System.Console.CmdArgs.Explicit.Complete.html#complete"><span class="hs-identifier hs-var">complete</span></a></span><span> </span><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279297"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; [String]) -&gt; [String] -&gt; [String]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279302"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679279309"><span class="hs-identifier hs-var">argInd</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679279327"><span class="hs-identifier hs-var">argPos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>            </span><span class="annot"><span class="annottext">ExitCode -&gt; IO a
forall a. ExitCode -&gt; IO a
</span><span class="hs-identifier hs-var">exitWith</span></span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><span class="hs-identifier hs-var">ExitSuccess</span></span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>            </span><span id="local-6989586621679279336"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279336"><span class="hs-identifier hs-var">nam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getProgName</span></span><span>
</span><span id="line-112"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679279348"><span class="annot"><span class="annottext">var :: Maybe String
</span><a href="#local-6989586621679279348"><span class="hs-identifier hs-var hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Maybe String
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">mplus</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [(String, String)] -&gt; Maybe String
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CMDARGS_HELPER_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toUpper</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Mode a -&gt; [String]
forall a. Mode a -&gt; [String]
</span><a href="System.Console.CmdArgs.Explicit.Type.html#modeNames"><span class="hs-identifier hs-var">modeNames</span></a></span><span> </span><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279297"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279336"><span class="hs-identifier hs-var">nam</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679279298"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [(String, String)] -&gt; Maybe String
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CMDARGS_HELPER&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679279298"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679279348"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-115"></span><span>                </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Mode a -&gt; [String] -&gt; IO a
forall a. Mode a -&gt; [String] -&gt; IO a
</span><a href="System.Console.CmdArgs.Explicit.html#processValueIO"><span class="hs-identifier hs-var">processValueIO</span></a></span><span> </span><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279297"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; IO a) -&gt; IO [String] -&gt; IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Mode a -&gt; Bool
forall a. Mode a -&gt; Bool
</span><a href="System.Console.CmdArgs.Explicit.Type.html#modeExpandAt"><span class="hs-identifier hs-var">modeExpandAt</span></a></span><span> </span><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279297"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO [String]
</span><a href="System.Console.CmdArgs.Explicit.ExpandArgsAt.html#expandArgsAt"><span class="hs-identifier hs-var">expandArgsAt</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO [String]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; IO [String]) -&gt; IO [String] -&gt; IO [String]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO [String]
</span><span class="hs-identifier hs-var">getArgs</span></span><span>
</span><span id="line-116"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679279355"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279355"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-117"></span><span>                    </span><span id="local-6989586621679279356"><span class="annot"><span class="annottext">Either String [String]
</span><a href="#local-6989586621679279356"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mode a -&gt; [String] -&gt; IO (Either String [String])
forall a.
String -&gt; Mode a -&gt; [String] -&gt; IO (Either String [String])
</span><a href="System.Console.CmdArgs.Helper.html#execute"><span class="hs-identifier hs-var">execute</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279355"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279297"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-118"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String [String]
</span><a href="#local-6989586621679279356"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-119"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679279358"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279358"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>                            </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error when running helper &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279355"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-121"></span><span>                            </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279358"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-122"></span><span>                            </span><span class="annot"><span class="annottext">IO a
forall a. IO a
</span><span class="hs-identifier hs-var">exitFailure</span></span><span>
</span><span id="line-123"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679279362"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279362"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Mode a -&gt; [String] -&gt; IO a
forall a. Mode a -&gt; [String] -&gt; IO a
</span><a href="System.Console.CmdArgs.Explicit.html#processValueIO"><span class="hs-identifier hs-var">processValueIO</span></a></span><span> </span><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279297"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279362"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span id="local-6989586621679279180"><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#readMay"><span class="hs-identifier hs-type">readMay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679279180"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679279180"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-127"></span><span id="readMay"><span class="annot"><span class="annottext">readMay :: forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="System.Console.CmdArgs.Explicit.html#readMay"><span class="hs-identifier hs-var hs-var">readMay</span></a></span></span><span> </span><span id="local-6989586621679279365"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279365"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279366"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679279366"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279366"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679279367"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279367"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS a
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279365"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS String
</span><span class="hs-identifier hs-var">lex</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279367"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-128"></span><span>                </span><span class="hs-special">[</span><span id="local-6989586621679279370"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279370"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279370"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-129"></span><span>                </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-cpp">


#if __GLASGOW_HASKELL__ &lt; 800
</span><span class="hs-identifier">errorWithoutStackTrace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-134"></span><span class="hs-identifier">errorWithoutStackTrace</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | Process a list of flags (usually obtained from @'getArgs'@ and @'expandArgsAt'@) with a mode.</span><span>
</span><span id="line-138"></span><span class="hs-comment">--   Throws an error if the command line fails to parse, or returns</span><span>
</span><span id="line-139"></span><span class="hs-comment">--   the associated value. Implemeneted in terms of 'process'. This function</span><span>
</span><span id="line-140"></span><span class="hs-comment">--   does not take account of any environment variables that may be set</span><span>
</span><span id="line-141"></span><span class="hs-comment">--   (see 'processArgs').</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">--   If you are in 'IO' you will probably get a better user experience by calling 'processValueIO'.</span><span>
</span><span id="line-144"></span><span id="local-6989586621679279214"><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#processValue"><span class="hs-identifier hs-type">processValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679279214"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679279214"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-145"></span><span id="processValue"><span class="annot"><span class="annottext">processValue :: forall a. Mode a -&gt; [String] -&gt; a
</span><a href="System.Console.CmdArgs.Explicit.html#processValue"><span class="hs-identifier hs-var hs-var">processValue</span></a></span></span><span> </span><span id="local-6989586621679279371"><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279371"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679279372"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279372"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Mode a -&gt; [String] -&gt; Either String a
forall a. Mode a -&gt; [String] -&gt; Either String a
</span><a href="System.Console.CmdArgs.Explicit.Process.html#process"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279371"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279372"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679279373"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279373"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. String -&gt; a
</span><span class="hs-identifier hs-var">errorWithoutStackTrace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279373"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679279375"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279375"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279375"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><span class="hs-comment">-- | Like 'processValue' but on failure prints to stderr and exits the program.</span></span><span>
</span><span id="line-150"></span><span id="local-6989586621679279203"><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#processValueIO"><span class="hs-identifier hs-type">processValueIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679279203"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679279203"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-151"></span><span id="processValueIO"><span class="annot"><span class="annottext">processValueIO :: forall a. Mode a -&gt; [String] -&gt; IO a
</span><a href="System.Console.CmdArgs.Explicit.html#processValueIO"><span class="hs-identifier hs-var hs-var">processValueIO</span></a></span></span><span> </span><span id="local-6989586621679279378"><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279378"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679279379"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279379"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Mode a -&gt; [String] -&gt; Either String a
forall a. Mode a -&gt; [String] -&gt; Either String a
</span><a href="System.Console.CmdArgs.Explicit.Process.html#process"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">Mode a
</span><a href="#local-6989586621679279378"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679279379"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679279380"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279380"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279380"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">IO a
forall a. IO a
</span><span class="hs-identifier hs-var">exitFailure</span></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679279381"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279381"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279381"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">-- | Create a help flag triggered by @-?@/@--help@.</span></span><span>
</span><span id="line-157"></span><span id="local-6989586621679279220"><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagHelpSimple"><span class="hs-identifier hs-type">flagHelpSimple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679279220"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679279220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679279220"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-158"></span><span id="flagHelpSimple"><span class="annot"><span class="annottext">flagHelpSimple :: forall a. (a -&gt; a) -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.html#flagHelpSimple"><span class="hs-identifier hs-var hs-var">flagHelpSimple</span></a></span></span><span> </span><span id="local-6989586621679279382"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679279382"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
forall a. [String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.Type.html#flagNone"><span class="hs-identifier hs-var">flagNone</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;help&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;?&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679279382"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Display help message&quot;</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | Create a help flag triggered by @-?@/@--help@. The user</span><span>
</span><span id="line-162"></span><span class="hs-comment">--   may optionally modify help by specifying the format, such as:</span><span>
</span><span id="line-163"></span><span class="hs-comment">--</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- &gt; --help=all          - help for all modes</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- &gt; --help=html         - help in HTML format</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- &gt; --help=100          - wrap the text at 100 characters</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- &gt; --help=100,one      - full text wrapped at 100 characters</span><span>
</span><span id="line-168"></span><span id="local-6989586621679279226"><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagHelpFormat"><span class="hs-identifier hs-type">flagHelpFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Help.html#HelpFormat"><span class="hs-identifier hs-type">HelpFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Text.html#TextFormat"><span class="hs-identifier hs-type">TextFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679279226"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679279226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679279226"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-169"></span><span id="flagHelpFormat"><span class="annot"><span class="annottext">flagHelpFormat :: forall a. (HelpFormat -&gt; TextFormat -&gt; a -&gt; a) -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.html#flagHelpFormat"><span class="hs-identifier hs-var hs-var">flagHelpFormat</span></a></span></span><span> </span><span id="local-6989586621679279392"><span class="annot"><span class="annottext">HelpFormat -&gt; TextFormat -&gt; a -&gt; a
</span><a href="#local-6989586621679279392"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Update a -&gt; String -&gt; String -&gt; Flag a
forall a.
String -&gt; [String] -&gt; Update a -&gt; String -&gt; String -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.Type.html#flagOpt"><span class="hs-identifier hs-var">flagOpt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;help&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;?&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Update a
</span><a href="#local-6989586621679279393"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Display help message&quot;</span></span><span class="hs-special">)</span><span class="hs-special">{</span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#flagInfo"><span class="hs-identifier hs-var">flagInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#FlagOptRare"><span class="hs-identifier hs-type">FlagOptRare</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">}</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>        </span><span id="local-6989586621679279393"><span class="annot"><span class="annottext">upd :: Update a
</span><a href="#local-6989586621679279393"><span class="hs-identifier hs-var hs-var">upd</span></a></span></span><span> </span><span id="local-6989586621679279396"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279396"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679279397"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279397"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (HelpFormat, TextFormat)
</span><a href="#local-6989586621679279398"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279396"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-172"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679279399"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279399"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279399"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-173"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679279400"><span class="annot"><span class="annottext">HelpFormat
</span><a href="#local-6989586621679279400"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679279401"><span class="annot"><span class="annottext">TextFormat
</span><a href="#local-6989586621679279401"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either String a) -&gt; a -&gt; Either String a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HelpFormat -&gt; TextFormat -&gt; a -&gt; a
</span><a href="#local-6989586621679279392"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">HelpFormat
</span><a href="#local-6989586621679279400"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TextFormat
</span><a href="#local-6989586621679279401"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679279397"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><a href="#local-6989586621679279398"><span class="hs-identifier hs-type">format</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Help.html#HelpFormat"><span class="hs-identifier hs-type">HelpFormat</span></a></span><span class="hs-special">,</span><span class="annot"><a href="System.Console.CmdArgs.Text.html#TextFormat"><span class="hs-identifier hs-type">TextFormat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>        </span><span id="local-6989586621679279398"><span class="annot"><span class="annottext">format :: String -&gt; Either String (HelpFormat, TextFormat)
</span><a href="#local-6989586621679279398"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span id="local-6989586621679279402"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279402"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either String (HelpFormat, TextFormat)
 -&gt; String -&gt; Either String (HelpFormat, TextFormat))
-&gt; Either String (HelpFormat, TextFormat)
-&gt; [String]
-&gt; Either String (HelpFormat, TextFormat)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679279404"><span class="annot"><span class="annottext">Either String (HelpFormat, TextFormat)
</span><a href="#local-6989586621679279404"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679279405"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279405"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (HelpFormat, TextFormat)
-&gt; Either String (HelpFormat, TextFormat)
</span><a href="#local-6989586621679279406"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279405"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((HelpFormat, TextFormat)
 -&gt; Either String (HelpFormat, TextFormat))
-&gt; Either String (HelpFormat, TextFormat)
-&gt; Either String (HelpFormat, TextFormat)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Either String (HelpFormat, TextFormat)
</span><a href="#local-6989586621679279404"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HelpFormat, TextFormat) -&gt; Either String (HelpFormat, TextFormat)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(HelpFormat, TextFormat)
forall a. Default a =&gt; a
</span><a href="System.Console.CmdArgs.Default.html#def"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String]
</span><a href="#local-6989586621679279408"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279402"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>                </span><span id="local-6989586621679279408"><span class="annot"><span class="annottext">sep :: String -&gt; [String]
</span><a href="#local-6989586621679279408"><span class="hs-identifier hs-var hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String]) -&gt; (String -&gt; String) -&gt; String -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679279412"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679279412"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679279412"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:,&quot;</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679279412"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>                </span><span id="local-6989586621679279406"><span class="annot"><span class="annottext">f :: String
-&gt; (HelpFormat, TextFormat)
-&gt; Either String (HelpFormat, TextFormat)
</span><a href="#local-6989586621679279406"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679279417"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279417"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679279418"><span class="annot"><span class="annottext">HelpFormat
</span><a href="#local-6989586621679279418"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679279419"><span class="annot"><span class="annottext">TextFormat
</span><a href="#local-6989586621679279419"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279417"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;all&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HelpFormat, TextFormat) -&gt; Either String (HelpFormat, TextFormat)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HelpFormat
</span><a href="System.Console.CmdArgs.Explicit.Help.html#HelpFormatAll"><span class="hs-identifier hs-var">HelpFormatAll</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TextFormat
</span><a href="#local-6989586621679279419"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;one&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HelpFormat, TextFormat) -&gt; Either String (HelpFormat, TextFormat)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HelpFormat
</span><a href="System.Console.CmdArgs.Explicit.Help.html#HelpFormatOne"><span class="hs-identifier hs-var">HelpFormatOne</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TextFormat
</span><a href="#local-6989586621679279419"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;def&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HelpFormat, TextFormat) -&gt; Either String (HelpFormat, TextFormat)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HelpFormat
</span><a href="System.Console.CmdArgs.Explicit.Help.html#HelpFormatDefault"><span class="hs-identifier hs-var">HelpFormatDefault</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TextFormat
</span><a href="#local-6989586621679279419"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;html&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HelpFormat, TextFormat) -&gt; Either String (HelpFormat, TextFormat)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HelpFormat
</span><a href="#local-6989586621679279418"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TextFormat
</span><a href="System.Console.CmdArgs.Text.html#HTML"><span class="hs-identifier hs-var">HTML</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;text&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HelpFormat, TextFormat) -&gt; Either String (HelpFormat, TextFormat)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HelpFormat
</span><a href="#local-6989586621679279418"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TextFormat
</span><a href="System.Console.CmdArgs.Text.html#defaultWrap"><span class="hs-identifier hs-var">defaultWrap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bash&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HelpFormat, TextFormat) -&gt; Either String (HelpFormat, TextFormat)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HelpFormat
</span><a href="System.Console.CmdArgs.Explicit.Help.html#HelpFormatBash"><span class="hs-identifier hs-var">HelpFormatBash</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; TextFormat
</span><a href="System.Console.CmdArgs.Text.html#Wrap"><span class="hs-identifier hs-var">Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;zsh&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HelpFormat, TextFormat) -&gt; Either String (HelpFormat, TextFormat)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HelpFormat
</span><a href="System.Console.CmdArgs.Explicit.Help.html#HelpFormatZsh"><span class="hs-identifier hs-var">HelpFormatZsh</span></a></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; TextFormat
</span><a href="System.Console.CmdArgs.Text.html#Wrap"><span class="hs-identifier hs-var">Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279417"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(HelpFormat, TextFormat) -&gt; Either String (HelpFormat, TextFormat)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HelpFormat
</span><a href="#local-6989586621679279418"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; TextFormat
</span><a href="System.Console.CmdArgs.Text.html#Wrap"><span class="hs-identifier hs-var">Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; TextFormat) -&gt; Int -&gt; TextFormat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679279417"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (HelpFormat, TextFormat)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unrecognised help format, expected one of: all one def html text &lt;NUMBER&gt;&quot;</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><span class="hs-comment">-- | Create a version flag triggered by @-V@/@--version@.</span></span><span>
</span><span id="line-192"></span><span id="local-6989586621679279430"><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagVersion"><span class="hs-identifier hs-type">flagVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679279430"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679279430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679279430"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-193"></span><span id="flagVersion"><span class="annot"><span class="annottext">flagVersion :: forall a. (a -&gt; a) -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.html#flagVersion"><span class="hs-identifier hs-var hs-var">flagVersion</span></a></span></span><span> </span><span id="local-6989586621679279431"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679279431"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
forall a. [String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.Type.html#flagNone"><span class="hs-identifier hs-var">flagNone</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;version&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;V&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679279431"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Print version information&quot;</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><span class="hs-comment">-- | Create a version flag triggered by @--numeric-version@.</span></span><span>
</span><span id="line-196"></span><span id="local-6989586621679279432"><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagNumericVersion"><span class="hs-identifier hs-type">flagNumericVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679279432"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679279432"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679279432"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-197"></span><span id="flagNumericVersion"><span class="annot"><span class="annottext">flagNumericVersion :: forall a. (a -&gt; a) -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.html#flagNumericVersion"><span class="hs-identifier hs-var hs-var">flagNumericVersion</span></a></span></span><span> </span><span id="local-6989586621679279433"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679279433"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
forall a. [String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.Type.html#flagNone"><span class="hs-identifier hs-var">flagNone</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;numeric-version&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679279433"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Print just the version number&quot;</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Create verbosity flags triggered by @-v@/@--verbose@ and</span><span>
</span><span id="line-201"></span><span class="hs-comment">--   @-q@/@--quiet@</span><span>
</span><span id="line-202"></span><span id="local-6989586621679279250"><span class="annot"><a href="System.Console.CmdArgs.Explicit.html#flagsVerbosity"><span class="hs-identifier hs-type">flagsVerbosity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Console.CmdArgs.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679279250"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679279250"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="System.Console.CmdArgs.Explicit.Type.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679279250"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-203"></span><span id="flagsVerbosity"><span class="annot"><span class="annottext">flagsVerbosity :: forall a. (Verbosity -&gt; a -&gt; a) -&gt; [Flag a]
</span><a href="System.Console.CmdArgs.Explicit.html#flagsVerbosity"><span class="hs-identifier hs-var hs-var">flagsVerbosity</span></a></span></span><span> </span><span id="local-6989586621679279434"><span class="annot"><span class="annottext">Verbosity -&gt; a -&gt; a
</span><a href="#local-6989586621679279434"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
forall a. [String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.Type.html#flagNone"><span class="hs-identifier hs-var">flagNone</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;verbose&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;v&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Verbosity -&gt; a -&gt; a
</span><a href="#local-6989586621679279434"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="System.Console.CmdArgs.Verbosity.html#Loud"><span class="hs-identifier hs-var">Loud</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Loud verbosity&quot;</span></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">[String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
forall a. [String] -&gt; (a -&gt; a) -&gt; String -&gt; Flag a
</span><a href="System.Console.CmdArgs.Explicit.Type.html#flagNone"><span class="hs-identifier hs-var">flagNone</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;quiet&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;q&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Verbosity -&gt; a -&gt; a
</span><a href="#local-6989586621679279434"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="System.Console.CmdArgs.Verbosity.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Quiet verbosity&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-206"></span></pre></body></html>